# 文件夹复制查看工具 

一个功能强大的Python桌面应用，用于文件夹复制、加密和解密操作。支持文件和目录的加密复制，以及加密文件的查看和浏览功能。

## 功能特性

### 📁 文件夹复制功能
- **智能文件夹复制**: 支持递归复制整个文件夹结构
- **进度显示**: 实时显示复制进度、当前文件和完成百分比
- **错误处理**: 智能处理复制过程中的错误，提供跳过、重试等选项，可以勾选之后一直相同操作
- **文件冲突处理**: 当目标文件已存在时，提供替换、跳过等选项，可以勾选之后一直相同操作
- **多线程处理**: 复制操作在后台线程进行，界面保持响应
- **日志记录**: 详细的操作日志，便于追踪和调试

### 🔐 加密/解密功能
- **文件加密**: 支持在复制过程中对文件进行加密，使用AES-256算法加盐加密,可以添加密码
- **文件解密**: 支持在复制过程中对加密文件进行解密，使用AES-256算法加盐解密,可以添加密码
- **目录加密**: 支持对目录名称进行加密
- **目录解密**: 支持对加密目录名称进行解密
- **密码保护**: 使用强加密算法保护文件安全

### 👁️ 查看功能
- **文件夹浏览**: 选择文件夹目录，浏览其中的文件和子文件夹
- **缩略图显示**: 自动为图片文件生成缩略图并显示，图片支持webp格式
- **图片查看**: 双击缩略图可以查看完整图片
- **文件打开**: 双击普通文件可以使用系统默认程序打开
- **导航功能**: 支持前进、后退操作，已加载的文件夹不会重新加载
- **解密查看**: 支持直接查看加密文件内容（需输入密码）

### 🚀 性能优化
- **多线程处理**: 文件和目录加载采用多线程异步进行
- **缓存系统**: 智能缓存已加载的文件夹内容和缩略图，提高性能
- **队列处理**: 使用消息队列处理UI更新，避免界面卡顿
- **内存优化**: 大文件处理时自动调整缓冲区大小，避免内存问题


### 依赖项说明
- `cryptography>=3.4.8`: 用于文件加密和解密功能
- `Pillow>=8.0.0`: 用于图片处理和缩略图生成

## 使用方法


### 2. 文件复制操作

#### 基本复制
1. 在"文件复制"选项卡中，点击"浏览..."按钮选择源文件夹
2. 点击"浏览..."按钮选择目标文件夹
3. 点击"开始复制"按钮开始复制

#### 加密复制
1. 选择源文件夹和目标文件夹
2. 勾选"加密文件"选项
3. 输入加密密码
4. 可选择是否加密目录名称（通过菜单栏的"加密/解密"菜单）
5. 点击"开始复制"按钮

#### 解密复制
1. 选择包含加密文件的源文件夹
2. 选择目标文件夹
3. 勾选"解密文件"选项
4. 输入解密密码（必须与加密时使用的密码相同）
5. 可选择是否解密目录名称
6. 点击"开始复制"按钮

### 3. 查看功能

#### 基本浏览
1. 切换到"查看"选项卡
2. 点击"选择文件夹"按钮选择要浏览的文件夹
3. 浏览文件和文件夹内容

#### 查看加密文件
1. 在"查看"选项卡中选择包含加密文件的文件夹
2. 在密码输入框中输入解密密码
3. 勾选"解密文件"和/或"解密目录"选项
4. 系统会自动解密并显示文件内容

#### 导航操作
- 使用"后退"和"前进"按钮进行导航
- 双击文件夹图标进入子文件夹
- 双击图片文件查看完整图片
- 双击普通文件使用系统默认程序打开

## 界面说明

### 文件复制选项卡
- **源文件夹**: 选择要复制的源文件夹路径
- **目标文件夹**: 选择复制到的目标文件夹路径
- **加密/解密选项**: 配置文件和目录的加密/解密设置
- **密码输入**: 输入加密/解密密码
- **控制按钮**: 开始复制和取消操作
- **进度条**: 显示复制进度
- **当前文件**: 显示正在处理的文件名
- **日志区域**: 显示详细的操作日志

### 查看选项卡
- **文件夹选择**: 选择要浏览的文件夹
- **密码输入**: 输入解密密码
- **导航按钮**: 后退、前进功能
- **文件显示区域**: 以缩略图形式显示文件和文件夹
- **状态栏**: 显示当前操作状态

### 菜单栏
- **加密/解密**: 统一的目录加密/解密选项控制；在文件复制选项卡中，勾选加密，则表示文件夹名加密；如果勾选解密，则表示文件夹名解密。在查看选项卡中，则表示文件夹名解密。

## 技术特点

### 加密技术
- 使用Fernet对称加密算法（基于AES-128-CBC）
- 密码通过PBKDF2HMAC算法进行密钥派生
- 支持文件内容和文件名的加密
- 加密文件添加.encrypted后缀便于识别

### 界面技术
- 使用tkinter构建现代化GUI界面
- 采用ttk主题控件，提供更好的视觉效果
- 多选项卡设计，功能分区清晰
- 响应式布局，支持窗口大小调整

### 性能优化
- **智能缓冲区**: 根据文件大小自动调整复制缓冲区
  - 小文件（<10MB）：1MB缓冲区
  - 中等文件（10-100MB）：256KB缓冲区
  - 大文件（>100MB）：64KB缓冲区
- **缓存系统**: 文件夹内容和缩略图缓存，避免重复加载
- **队列处理**: 使用消息队列处理UI更新，避免界面卡顿
- **递归保护**: 防止队列处理的无限递归调用

## 错误处理

### 复制错误
- 文件访问权限错误
- 磁盘空间不足
- 网络路径不可用
- 提供跳过、重试、取消等选项
- 支持应用到所有后续文件

### 文件冲突
- 目标文件已存在时的处理
- 提供替换、跳过、取消等选项
- 支持应用到所有后续文件

### 加密错误
- 密码错误时的处理
- 加密算法错误的处理
- 文件损坏时的处理

---

## 打包与发布（EXE/安装器）

以下命令均在项目根目录执行，要求已安装 Maven。

### 环境要求
- Windows 平台
- JDK 11+（用于编译与 jlink）；JDK 14+（提供 jpackage，用于生成安装器）
- 确保 `JAVA_HOME` 指向包含对应工具的 JDK，且 `mvn -v` 正常

### 1）生成可直接运行的应用目录（免安装 Java）
- 命令：
  ```
  mvn -DskipTests clean package
  ```
- 产物：`target/app/`
  - `encrypted-file-explorer.exe`（Windows 可执行程序）
  - `jre/`（通过 jlink 生成的最小运行时）
  - `${artifactId}-${version}-all.jar`（包含全部依赖的可运行 JAR）
- 使用：双击 `target/app/encrypted-file-explorer.exe` 即可运行，无需本机安装 Java

### 2）生成单文件安装包（一键安装）
- 命令：
  ```
  mvn -DskipTests clean verify -Pinstaller
  ```
- 产物：`target/installer/Encrypted File Explorer-${version}.exe`
- 功能：
  - 支持选择安装目录
  - 可创建开始菜单项、桌面快捷方式
  - 安装包内已包含最小运行时，安装后可直接使用

### 常见问题
- 若构建安装器报错提示 `jpackage` 不存在：请改用 JDK 14+ 并确保 `JAVA_HOME/bin` 下存在 `jpackage`。
- 若杀软误报：建议对生成的 `.exe` 进行代码签名，或仅分发 `target/app/` 目录。
- 如需自定义图标/名称：可在 `pom.xml` 的 `launch4j` 与 `jpackage`（installer profile）配置中添加 `icon`、`vendor` 等参数。
